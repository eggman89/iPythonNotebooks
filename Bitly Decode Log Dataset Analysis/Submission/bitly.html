<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>bitly - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/img/favicon.ico"/>
<script>window.settings = {"sparkDocsSearchGoogleCx":"004588677886978090460:_rj0wilqwdm","dbcForumURL":"http://forums.databricks.com/","dbfsS3Host":"https://databricks-prod-storage-oregon.s3.amazonaws.com","enableThirdPartyApplicationsUI":false,"enableClusterAcls":false,"notebookRevisionVisibilityHorizon":6,"enableTableHandler":true,"isAdmin":true,"enablePresentationTimerConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"clusters":true,"hideOffHeapCache":false,"applications":false,"useStaticGuide":false,"fileStoreBase":"FileStore","configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableResetPassword":true,"sparkVersions":[{"key":"1.3.x","displayName":"Spark 1.3.0","packageLabel":"spark-1.3-jenkins-ip-10-2-0-239-U46e7af8a4d-Sa2ee4664b2-2016-01-06-22:41:50.126623","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.4.x","displayName":"Spark 1.4.1","packageLabel":"spark-1.4-jenkins-ip-10-2-0-239-U46e7af8a4d-S33a1e4b9c6-2016-01-06-22:41:50.126623","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-239-U46e7af8a4d-S3a937ddfc0-2016-01-06-22:41:50.126623","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x","displayName":"Spark 1.6.0","packageLabel":"spark-1.6-jenkins-ip-10-2-0-239-U46e7af8a4d-Sf760028923-2016-01-06-22:41:50.126623","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"master","displayName":"Spark master (dev)","packageLabel":"","upgradable":true,"deprecated":false,"customerVisible":false}],"enableRestrictedClusterCreation":false,"enableFeedback":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","driverStdoutFilePrefix":"stdout","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableNotebookHistoryDiffing":true,"branch":"2.10.1","local":false,"displayDefaultContainerMemoryGB":30,"deploymentMode":"production","useSpotForWorkers":false,"enableStaticNotebooks":true,"dbcGuideURL":"#workspace/databricks_guide/00 Welcome to Databricks","enableCssTransitions":true,"enableClusterAclsConfig":false,"orgId":0,"enableNotebookGitVersioning":true,"files":"files/","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewDashboardViews":false,"driverLog4jFilePrefix":"log4j","enableMavenLibraries":true,"defaultSparkVersion":{"key":"1.5.x","displayName":"Spark 1.5.2","packageLabel":"spark-1.5-jenkins-ip-10-2-0-239-U46e7af8a4d-S3a937ddfc0-2016-01-06-22:41:50.126623","upgradable":true,"deprecated":false,"customerVisible":true},"clusterPublisherRootId":5,"enableLatestJobRunResultPermalink":true,"enableSparkConfUI":true,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"csrfToken":"c64e8f63-2bdb-45d2-a0be-7a197d3e1a9a","useFixedStaticNotebookVersionForDevelopment":false,"enableBasicReactDialogBoxes":true,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableWorkspaceAclService":true,"enableWorkspaceAcls":false,"gitHash":"46e7af8a4d4185dce6c51957db857079eb78e351","userFullname":"Krishna Agarwala","enableImportFromUrl":true,"enableMiniClusters":false,"enableWebSocketDeltaUpdates":true,"enableDebugUI":false,"showHiddenSparkVersions":false,"allowNonAdminUsers":false,"userId":100004,"dbcSupportURL":"","staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/","enableSparkPackages":true,"enableNotebookHistoryUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"databricksGuideStaticUrl":"","notebookLoadingBackground":"#fff","enableNewJobRunDetailsPage":true,"enableDashboardExport":true,"user":"kagarwa@ncsu.edu","enableServerAutoComplete":true,"enableStaticHtmlImport":true,"defaultMemoryPerContainerMB":28000,"enablePresenceUI":true,"tablesPublisherRootId":7,"accounts":true,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":4280,"name":"bitly","language":"python","commands":[{"version":"CommandV1","origId":4284,"guid":"ecb8dbe9-c836-4350-a729-d97ff77e1a5c","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n#####Details of the analysis\n\n######Setup:\nDue to the hardware limitations of my laptop while processing large volume of data, I'm currently deploying the data on cloud server. This particular notebook is running on a cloud server instance provided by databricks.com. The data is stored/proessed from Amazon S3. \n\nThe 6 JSON files provided for the analysis have been uploaded into the databricks database. They are named decodes01, decodes02 ..decodes06.\n\n######Details of cluster:\n1 Master Node, 4 Worker Nodes with 30 GB memory in each of them.\n\n######Nature of the analysis:\nI would be using mainly Apache Spark dataframes and SQL context to perform the analysis, due to it's efficiency in distributed computing. Whenever required I would be switiching to pandas dataframe. I would be using the databricks.com tool to draw the graphs.\n\n######External Python Libraries Used:\n- httpagentparser  \n- numpy  \n- pandas  \n- matplotlib \n- iso3166 : to convert Country code","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100242E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"be994323-db0f-44d7-8ddc-1bfa48978bb2"},{"version":"CommandV1","origId":4290,"guid":"d497a66c-daa5-48a6-a0d3-004713e28cbb","subtype":"command","commandType":"auto","position":4.0,"command":"#imports and initial setup\nimport numpy as np\nimport pandas as pd\nimport httpagentparser\nfrom iso3166 import countries\nimport matplotlib.pyplot as plt\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import StringType\n\n#method to convert Spark Dataframe to Pandas DataFrame\ndef rows_to_def(rows):\n    return pd.DataFrame(map(lambda e: e.asDict(), rows))\n  \n#load the 6 tables in 6 dataframes and merge into a single one at the end\ndf1 = sqlContext.sql(\"select * from decodes01\")\ndf2 = sqlContext.sql(\"select * from decodes02\")\ndf3 = sqlContext.sql(\"select * from decodes03\")\ndf4 = sqlContext.sql(\"select * from decodes04\")\ndf5 = sqlContext.sql(\"select * from decodes05\")\ndf6 = sqlContext.sql(\"select * from decode06\")\nDFrame = df1.unionAll(df2).unionAll(df3).unionAll(df4).unionAll(df5).unionAll(df6)\nDFrame.cache()\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">2</span><span class=\"ansired\">]: </span>DataFrame[a: string, c: string, ckw: string, cy: string, dp: string, g: string, h: string, kw: string, mc: bigint, nk: bigint, pp: string, t: bigint, tz: string, u: string]\n</div>","arguments":{},"plotOptions":null},"errorSummary":"<span class=\"ansired\">ImportError</span>: No module named iso3166","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">ImportError</span>                               Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-1-8d890de800d4&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansigreen\">import</span> pandas <span class=\"ansigreen\">as</span> pd<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansigreen\">import</span> httpagentparser<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 5</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">from</span> iso3166 <span class=\"ansigreen\">import</span> countries<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span> <span class=\"ansigreen\">import</span> matplotlib<span class=\"ansiyellow\">.</span>pyplot <span class=\"ansigreen\">as</span> plt<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span> <span class=\"ansigreen\">from</span> pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>functions <span class=\"ansigreen\">import</span> udf<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">ImportError</span>: No module named iso3166\n</div>","startTime":1.453664250174E12,"submitTime":1.453664254388E12,"finishTime":1.453664252906E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f7a2fd6e-ac6d-4935-8bc3-7d1117ac0dc3"},{"version":"CommandV1","origId":4325,"guid":"3d587429-f537-4c1e-b415-ace539dbc825","subtype":"command","commandType":"auto","position":4.5,"command":"print \"Total enteries in the dataset: \" + str(DFrame.count())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Total enteries in the dataset: 18825762\n</div>","arguments":{},"plotOptions":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664257004E12,"submitTime":1.453664261241E12,"finishTime":1.453664282244E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f8f61083-14c3-4066-acc7-88d8c7990906"},{"version":"CommandV1","origId":4315,"guid":"7cbe11c5-e8e3-4daf-8ef7-f0f99d809c4f","subtype":"command","commandType":"auto","position":5.5,"command":"%md\n####1. Stats By Platform \n\n- Platforms interacting with Bitlinks the most  \n- Most used browsers on Top 3 platforms to interact with Bitlinks\n- Android or OS? : Which platforms does the top 20 traffic generating countries prefer","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100317E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6b89e0d1-1d0c-4e8d-9d52-cefe5aa9bdad"},{"version":"CommandV1","origId":4295,"guid":"44ef899d-808d-4070-b068-2ceee9404225","subtype":"command","commandType":"auto","position":5.96875,"command":"#code needed for section 1  \n\n#methods to return OS, Platform or Broswser details, given a user_Agent string\ndef ua_det_os(user_agent):    \n    try:\n        details =  httpagentparser.detect(str(user_agent))\n        if 'os' in details:\n            return details['os']['name']\n        else:\n            return None\n    except:\n        return None\n\ndef ua_det_platform(user_agent):  \n    try:    \n        details =  httpagentparser.detect(str(user_agent))\n        if 'platform' in details:\n            if 'dist' in details:\n                return details['dist']['name']\n            elif 'platform' in details:\n                return details['platform']['name']        \n            else:\n                return None\n    except:\n        return None\n\ndef ua_det_browser(user_agent):   \n    try:\n        details =  httpagentparser.detect(str(user_agent))\n        if 'browser' in details:\n            return details['browser']['name']\n        else:\n            return None\n    except:\n        return None\n\nget_os = udf(lambda x:ua_det_os(x), StringType())\nget_platform = udf(lambda x:ua_det_platform(x), StringType())\nget_browser = udf(lambda x:ua_det_browser(x), StringType())\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664290142E12,"submitTime":1.453664294367E12,"finishTime":1.453664290272E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"02ae5392-2710-4adf-85c7-db9364f0bf6d"},{"version":"CommandV1","origId":4291,"guid":"ac89ec51-4587-47f7-9baf-4a082c6d31e7","subtype":"command","commandType":"auto","position":5.998046875,"command":"dftest = DFrame.withColumn('os',get_os(DFrame.a)).withColumn('browser',get_browser(DFrame.a)).withColumn('platform',get_platform(DFrame.a)).select('c','cy','a',\"os\",\"browser\",\"platform\",\"nk\",'h','g','u')\ndftest.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>DataFrame[c: string, cy: string, a: string, os: string, browser: string, platform: string, nk: bigint, h: string, g: string, u: string]\n</div>","arguments":{},"plotOptions":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664293767E12,"submitTime":1.453664298005E12,"finishTime":1.453664294145E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b651407c-2f7f-4962-aa53-22ff2117d44c"},{"version":"CommandV1","origId":4392,"guid":"1164b31d-2ec4-41b7-9db6-631665980592","subtype":"command","commandType":"auto","position":5.9990234375,"command":"%md \nPlatforms interacting with Bitlinks the most","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100396E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"fa491bc5-5bca-44f7-b475-1ec7cd955b68"},{"version":"CommandV1","origId":4300,"guid":"7ed8778f-b87b-4db5-84eb-85e8a97dfd59","subtype":"command","commandType":"auto","position":6.0,"command":"#Platforms interacting with Bitlinks the most  \ndfc = dftest.groupBy(\"platform\").count().sort(\"count\",ascending=False).select(\"platform\",\"count\")\ndisplay(dfc)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Windows",7205413.0],["Android",5387775.0],["iPhone",3704552.0],[[],1007582.0],["IPad",651986.0],["Mac OS",616510.0],["BlackBerry",103984.0],["Linux",74955.0],["Ubuntu",33549.0],[" ChromeOS",15369.0],["Symbian",15254.0],["Nokia S40",5489.0],["PlayStation",2748.0],["BlackberryPlaybook",431.0],["Debian",85.0],["WebOS",80.0]],"arguments":{},"schema":[{"name":"platform","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"startTime":1.453664297817E12,"submitTime":1.453664302044E12,"finishTime":1.453664635833E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"1063.33334","height":"348.33334","xColumns":["platform"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"pieChart":[{"key":"donut","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"c62b2858-d8db-4498-9b8b-fb1bd1d76d8a"},{"version":"CommandV1","origId":4393,"guid":"08b14cea-f175-42fb-853b-62c257126717","subtype":"command","commandType":"auto","position":6.5,"command":"%md\nMost used browsers on Top 3 platforms to interact with Bitlinks","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100483E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"f11a8d30-687e-43d9-914f-69755d92386a"},{"version":"CommandV1","origId":4301,"guid":"3ac823af-56f1-43e4-bbdd-5210e2fc3857","subtype":"command","commandType":"auto","position":7.0,"command":"#Most used browsers on Top 3 platforms to interact with Bitlinks\ndf_android = dftest.groupBy(\"platform\",\"browser\").count().sort(\"count\",ascending=False).select(\"platform\",\"browser\",\"count\").where(dftest['platform'] == \"Android\")\n\ndf_iPhone = dftest.groupBy(\"platform\",\"browser\").count().sort(\"count\",ascending=False).select(\"platform\",\"browser\",\"count\").where(dftest['platform'] == \"iPhone\")\n\ndf_Windows = dftest.groupBy(\"platform\",\"browser\").count().sort(\"count\",ascending=False).select(\"platform\",\"browser\",\"count\").where(dftest['platform'] == \"Windows\")\n\ndisplay(df_android.unionAll(df_iPhone).unionAll(df_Windows))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Android","Chrome",3391580.0],["Android","AndroidBrowser",1787371.0],["Android","Opera",187621.0],["Android","Firefox",18899.0],["Android","Opera Mobile",2301.0],["Android","MSEdge",2.0],["Android","Microsoft Internet Explorer",1.0],["iPhone",[],3294453.0],["iPhone","Safari",398719.0],["iPhone","ChromeiOS",9275.0],["iPhone","Opera",1241.0],["iPhone","UCBrowser",758.0],["iPhone","AndroidBrowser",86.0],["iPhone","Chrome",16.0],["iPhone","Firefox",4.0],["Windows","Microsoft Internet Explorer",3036040.0],["Windows","Chrome",2941815.0],["Windows","Firefox",1051748.0],["Windows","Opera",96199.0],["Windows","Safari",58736.0],["Windows",[],12400.0],["Windows","GoogleBot",3212.0],["Windows","UCBrowser",2671.0],["Windows","SeaMonkey",1391.0],["Windows","MSEdge",585.0],["Windows","Netscape",570.0],["Windows","Opera Mobile",40.0],["Windows","Konqueror",5.0],["Windows","YandexBot",1.0]],"arguments":{},"schema":[{"name":"platform","type":"\"string\""},{"name":"browser","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664710483E12,"submitTime":1.453664714713E12,"finishTime":1.453664720116E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"1342.33334","height":"463.33334","xColumns":["browser"],"yColumns":["count"],"pivotColumns":["platform"],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mapPlot":[],"histogram":[{"key":"bins","value":"20"}],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"boxPlot":[],"lineChart":[],"qqPlot":[],"quantilePlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"96cc462c-9298-4c48-b064-21ac0625d19e"},{"version":"CommandV1","origId":4394,"guid":"b9d59747-079a-4558-bf31-44f67d985cfe","subtype":"command","commandType":"auto","position":7.03125,"command":"%md\nAndroid or OS? : Which platforms does the top 20 traffic generating countries prefer","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100548E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"787cab41-32ac-4dd8-92b8-6b3d902f317f"},{"version":"CommandV1","origId":4391,"guid":"53c8aee7-f686-483e-b767-f8a93abfc2be","subtype":"command","commandType":"auto","position":7.0625,"command":"#Android or OS? : Which platforms does the top 20 traffic generating countries prefer\ndftest.registerTempTable('dftest')\ndf_top20 = dftest.groupBy('c').count().sort(\"count\",ascending = False).limit(20)\npdf_top20  = rows_to_def(df_top20.collect())\n\ntop20_countries = pdf_top20.set_index('c' ).index.get_level_values('c')\nsql_string1 = \"SELECT c,platform,count(c) FROM dftest WHERE (c IN (\"\nsql_string3 = \"')) AND (platform = 'Android' or platform = 'iPhone') GROUP BY c,platform\"\nsql_string2 = \"\"\nsql_string4 = []\n\n\nfor i,val in enumerate(top20_countries):    \n    sql_string4.append((val))    \nfor i in range(19):    \n    sql_string2 =sql_string2 + \"'\" + str(sql_string4[i]) + \"',\" \nsql_string2 = sql_string2 + \"'\" +sql_string4[19]\n\nsql_string = sql_string1 + sql_string2 +sql_string3\nprint sql_string\nres1 = sqlContext.sql(sql_string).groupBy('c','platform').sum()\ndisplay(res1.sort('sum(_c2)', ascending = False))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["US","iPhone",1425852.0],["US","Android",1168774.0],["BR","Android",371381.0],["TW","iPhone",276159.0],["JP","iPhone",262103.0],["TW","Android",242735.0],["GB","iPhone",234830.0],["TR","Android",219006.0],["DE","Android",215697.0],["IN","Android",207023.0],["ES","Android",194908.0],["IT","Android",193711.0],["MX","Android",152614.0],["ID","Android",146901.0],["GB","Android",139880.0],["JP","Android",117340.0],["DE","iPhone",116576.0],["TH","Android",111436.0],["FR","Android",103632.0],["MY","Android",100496.0],["CA","iPhone",99771.0],["AR","Android",94319.0],["IT","iPhone",91967.0],["BR","iPhone",91494.0],["FR","iPhone",84443.0],["TR","iPhone",75575.0],["AU","iPhone",68010.0],["MX","iPhone",66312.0],["CA","Android",60275.0],["RO","Android",55683.0],["TH","iPhone",53245.0],["ES","iPhone",49120.0],["VN","Android",36140.0],["AU","Android",36124.0],["MY","iPhone",24417.0],["IN","iPhone",21073.0],["ID","iPhone",17464.0],["RO","iPhone",17367.0],["VN","iPhone",15319.0],["AR","iPhone",6669.0]],"arguments":{},"schema":[{"name":"c","type":"\"string\""},{"name":"platform","type":"\"string\""},{"name":"sum(_c2)","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664726113E12,"submitTime":1.453664730358E12,"finishTime":1.453664729129E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"1461.997","height":"299.997","xColumns":["c"],"yColumns":["sum(_c2)"],"pivotColumns":["platform"],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"d6b0cd6e-d960-46df-aacc-8a4e2052cb82"},{"version":"CommandV1","origId":4309,"guid":"6c441552-fc64-45f7-b1f3-9a3038aa1d96","subtype":"command","commandType":"auto","position":8.0,"command":"%md\n######Conclusion\n\n- From that data we find that PC/Windows is still the most widely used platform when it comes to interaction with the Bitlinks.\n- However, the major two mobile platforms(iPhone and Android) combined have a significant lead compared to PC.\n- Despite having many big players in Android browser space, the default Browsers (Chrome and the Android Default) browser are used for over 90% of the interaction.\n- On PC, however things are divided. The default browser (IE) and Chrome have generates the same amount of traffic\n- Globally, most people use Android devices to access the Bitlinks. However in 4 out of the top 5 countries, more people use iPhone over Android devices. In the next 15 countries, Android devices are used a lot more (Except CA and AU).\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100614E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"844ee7cb-0651-4176-99e0-97bee83eaed7"},{"version":"CommandV1","origId":4316,"guid":"d5d89def-ec2b-418a-b6de-5af36d6b4548","subtype":"command","commandType":"auto","position":8.5,"command":"%md\n####2 .Stats By Country\n\n- Coutries with maximum traffic\n  - World Map\n  - Box Plot\n- Countries with maximum potential to expand traffic in\n  - Percentage of traffic generated by the top 10 countries\n  - Number of Internet users (per country) interacting with Bitlinks\n    - For this result, I've used the data the number of Internet users per country.\n    - The result has been acquired from here: https://en.wikipedia.org/wiki/List_of_countries_by_number_of_Internet_users\n    - The actual traffic has been mapped to the top 10 countries with most internet users\n\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.45366310066E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b42b28a4-16cf-4b81-9ff4-0acab1db35ee"},{"version":"CommandV1","origId":4395,"guid":"a87f9265-3128-4120-afc9-199c3b280add","subtype":"command","commandType":"auto","position":8.625,"command":"%md\nCountries with Most Internet users (Top 10)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100701E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"aff64ff6-8f16-481f-b932-40c82befc8d1"},{"version":"CommandV1","origId":4317,"guid":"d895d219-88d5-402b-80c7-adce06e7cc90","subtype":"command","commandType":"auto","position":8.75,"command":"#code needed for section 2\nfrom pyspark.sql.functions import lit\ndef ua_get_alpha3(alpha2):   \n    try:\n      str_alpha2 =  str(alpha2)\n      return countries.get(str_alpha2).alpha3\n    except:\n        return None\n#registering custom User Defined Functions\nget_alpha3 = udf(lambda x:ua_get_alpha3(x), StringType())\n\ndf_internetusers = sqlContext.sql(\"select * from InternetUsers\")\ndf_internetusers_with_code = df_internetusers.withColumn(\"c3_1\", lit(get_alpha3(df_internetusers.Country)))\n\ndisplay(df_internetusers.limit(10))\nprint \"Countries with Most Internet users (Top 10)\"","commandVersion":0,"state":"finished","results":{"type":"table","data":[["China",6.68110314E8],["India",4.02E8],["United States",2.66441302E8],["Japan",1.09755777E8],["Brazil",1.03720965E8],["Russia",8.7495296E7],["Indonesia",7.8E7],["Germany",6.8131244E7],["Nigeria",6.5675984E7],["United Kingdom",5.6954584E7]],"arguments":{},"schema":[{"name":"Country","type":"\"string\""},{"name":"InternetUsers","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664735536E12,"submitTime":1.453664739787E12,"finishTime":1.453664736619E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pivotTable","width":"1044.181818","height":"544.181818","xColumns":["Country"],"yColumns":["InternetUsers"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mapPlot":[],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"lineChart":[],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":"0.3"}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"230d10fa-17aa-4236-9d88-798c1c820236"},{"version":"CommandV1","origId":4396,"guid":"14c2e672-45b5-43de-a386-c6e05d9fb34c","subtype":"command","commandType":"auto","position":8.875,"command":"%md\nCoutries with maximum traffic : World Map","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663100796E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"bf8a009c-60d4-48b8-adda-c50491867bd8"},{"version":"CommandV1","origId":4304,"guid":"2557321f-f8dd-4b3a-b052-935ae56413ee","subtype":"command","commandType":"auto","position":9.0,"command":"#Coutries with maximum traffic : World Map\n#dfc = DFrame.groupBy(\"c\").count().sort(\"count\",ascending=False).select(\"c\",\"count\")\nfrom pyspark.sql.functions import lit\ndfc = DFrame.withColumn(\"c3\", lit(get_alpha3(DFrame.c))).select(\"c\",\"c3\").groupBy(\"c3\").count().sort(\"count\",ascending=False).select(\"c3\",\"count\")\ndisplay(dfc)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",6036988.0],["TWN",1049853.0],["BRA",946074.0],["JPN",716938.0],["GBR",651969.0],["DEU",566726.0],["FRA",556789.0],["ITA",542485.0],["TUR",517409.0],["IND",452955.0],["CAN",424256.0],["ESP",394887.0],["THA",284712.0],["MEX",279951.0],["IDN",275489.0],["ROU",269885.0],[[],255494.0],["VNM",224495.0],["ARG",207318.0],["MYS",178597.0],["AUS",176695.0],["SGP",174122.0],["PHL",163574.0],["RUS",161834.0],["SAU",156218.0],["COL",156014.0],["EGY",152909.0],["KOR",152883.0],["ISR",133204.0],["NLD",129296.0],["VEN",117643.0],["HKG",110075.0],["ZAF",94254.0],["CHL",92343.0],["POL",75721.0],["PER",70816.0],["ARE",67609.0],["BEL",67455.0],["PAK",62793.0],["AUT",62438.0],["MAR",62269.0],["IRL",58862.0],["CHN",58610.0],["GRC",56842.0],["UKR",55924.0],["CZE",54220.0],["CHE",50829.0],["ECU",49155.0],["SWE",48795.0],["BGR",47440.0],["DZA",45329.0],["DNK",41481.0],["GEO",41463.0],["PRT",34986.0],["HUN",34842.0],["KWT",32405.0],["NGA",31065.0],["GTM",30942.0],["PRI",30709.0],["IRQ",30125.0],["NOR",29062.0],["TUN",27120.0],["SRB",22628.0],["FIN",22304.0],["URY",21364.0],["DOM",20816.0],["JOR",20323.0],["HND",19646.0],["QAT",19598.0],["CRI",18814.0],["SVK",18380.0],["BGD",17636.0],["LBN",17321.0],["ALB",16315.0],["IRN",16261.0],["KEN",15723.0],["HRV",15304.0],["PAN",13646.0],["OMN",13381.0],["BOL",13197.0],["SLV",12950.0],["LTU",12448.0],["BHR",11250.0],["PRY",10917.0],["AZE",10241.0],["BIH",10171.0],["PSE",10008.0],["KAZ",9987.0],["SVN",9923.0],["ARM",9637.0],["BLR",9519.0],["LKA",9265.0],["KHM",8747.0],["MAC",8602.0],["GHA",7243.0],["NPL",7170.0],["LBY",6917.0],["MKD",6555.0],["SYR",6355.0],["CYP",6120.0],["YEM",5982.0],["LVA",5884.0],["MDA",5855.0],["TZA",5640.0],["NZL",5478.0],["TTO",5428.0],["LUX",5355.0],["EST",5278.0],["MLT",4861.0],["MUS",4573.0],["NIC",4416.0],["MMR",4338.0],["JAM",4288.0],["SDN",3695.0],["SEN",3652.0],["UGA",3634.0],["ISL",3384.0],["REU",3281.0],["MNG",3270.0],["BRN",3003.0],["LAO",2833.0],["CIV",2787.0],["ZWE",2600.0],["AGO",2217.0],["BWA",2005.0],["HTI",1909.0],["MNE",1776.0],["ETH",1697.0],["AFG",1679.0],["BRB",1668.0],["KGZ",1473.0],["MOZ",1460.0],["GLP",1369.0],["MTQ",1361.0],["BHS",1346.0],["MDV",1319.0],["CMR",1307.0],["GUM",1271.0],["NAM",1263.0],["ZMB",1204.0],["JEY",1197.0],["SUR",1095.0],["CUW",1072.0],["GUY",1001.0],["MLI",922.0],["ABW",888.0],["MDG",859.0],["UZB",834.0],["AND",827.0],["BLZ",801.0],["RWA",748.0],["GMB",719.0],["DJI",688.0],["GIN",668.0],["BEN",661.0],["GRD",653.0],["CYM",651.0],["IMN",630.0],["ATG",605.0],["BFA",605.0],["BMU",571.0],["GUF",565.0],["MRT",563.0],["LCA",552.0],["COD",514.0],["VIR",502.0],["CUB",469.0],["GAB",452.0],["FRO",435.0],["MWI",434.0],["CPV",427.0],["GIB",422.0],["GGY",413.0],["GRL",399.0],["PNG",386.0],["MCO",374.0],["TGO",359.0],["SYC",352.0],["NER",339.0],["LSO",330.0],["BTN",265.0],["KNA",264.0],["SOM",240.0],["VCT",238.0],["NCL",237.0],["MYT",224.0],["DMA",201.0],["SLE",190.0],["BDI",183.0],["LIE",173.0],["TCA",170.0],["LBR",170.0],["SMR",168.0],["TJK",166.0],["FJI",165.0],["SWZ",155.0],["COG",139.0],["ALA",128.0],["MNP",123.0],["BES",105.0],["TKM",101.0],["TCD",97.0],["PYF",82.0],["VGB",82.0],["MAF",80.0],["GNQ",60.0],["GNB",53.0],["AIA",47.0],["STP",44.0],["ASM",34.0],["SPM",34.0],["FSM",29.0],["MHL",27.0],["VUT",20.0],["COM",18.0],["CAF",16.0],["FLK",14.0],["ERI",14.0],["COK",12.0],["SLB",11.0],["PLW",9.0],["VAT",6.0],["MSR",6.0],["PRK",5.0],["IOT",3.0],["WLF",3.0],["TON",3.0],["ATA",2.0],["WSM",1.0],["KIR",1.0]],"arguments":{},"schema":[{"name":"c3","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664741247E12,"submitTime":1.453664745497E12,"finishTime":1.453664754591E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"mapPlot","width":"1371.33334","height":"496.33334","xColumns":["c3"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mapPlot":[],"lineChart":[],"qqPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"6374613f-5aef-4b44-97f0-42ae6b8189c5"},{"version":"CommandV1","origId":4397,"guid":"3118f2ea-c902-4339-a355-e72daadda4e1","subtype":"command","commandType":"auto","position":9.25,"command":"%md\nCoutries with maximum traffic : Box Chart","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.45366310091E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b9a1932f-ff62-4db5-8c49-5be79a54472a"},{"version":"CommandV1","origId":4311,"guid":"37686211-ceb1-4a42-8d5a-f0eac57921d8","subtype":"command","commandType":"auto","position":9.5,"command":"#Coutries with maximum traffic : Box Chart\ndisplay(dfc)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["USA",6036988.0],["TWN",1049853.0],["BRA",946074.0],["JPN",716938.0],["GBR",651969.0],["DEU",566726.0],["FRA",556789.0],["ITA",542485.0],["TUR",517409.0],["IND",452955.0],["CAN",424256.0],["ESP",394887.0],["THA",284712.0],["MEX",279951.0],["IDN",275489.0],["ROU",269885.0],[[],255494.0],["VNM",224495.0],["ARG",207318.0],["MYS",178597.0],["AUS",176695.0],["SGP",174122.0],["PHL",163574.0],["RUS",161834.0],["SAU",156218.0],["COL",156014.0],["EGY",152909.0],["KOR",152883.0],["ISR",133204.0],["NLD",129296.0],["VEN",117643.0],["HKG",110075.0],["ZAF",94254.0],["CHL",92343.0],["POL",75721.0],["PER",70816.0],["ARE",67609.0],["BEL",67455.0],["PAK",62793.0],["AUT",62438.0],["MAR",62269.0],["IRL",58862.0],["CHN",58610.0],["GRC",56842.0],["UKR",55924.0],["CZE",54220.0],["CHE",50829.0],["ECU",49155.0],["SWE",48795.0],["BGR",47440.0],["DZA",45329.0],["DNK",41481.0],["GEO",41463.0],["PRT",34986.0],["HUN",34842.0],["KWT",32405.0],["NGA",31065.0],["GTM",30942.0],["PRI",30709.0],["IRQ",30125.0],["NOR",29062.0],["TUN",27120.0],["SRB",22628.0],["FIN",22304.0],["URY",21364.0],["DOM",20816.0],["JOR",20323.0],["HND",19646.0],["QAT",19598.0],["CRI",18814.0],["SVK",18380.0],["BGD",17636.0],["LBN",17321.0],["ALB",16315.0],["IRN",16261.0],["KEN",15723.0],["HRV",15304.0],["PAN",13646.0],["OMN",13381.0],["BOL",13197.0],["SLV",12950.0],["LTU",12448.0],["BHR",11250.0],["PRY",10917.0],["AZE",10241.0],["BIH",10171.0],["PSE",10008.0],["KAZ",9987.0],["SVN",9923.0],["ARM",9637.0],["BLR",9519.0],["LKA",9265.0],["KHM",8747.0],["MAC",8602.0],["GHA",7243.0],["NPL",7170.0],["LBY",6917.0],["MKD",6555.0],["SYR",6355.0],["CYP",6120.0],["YEM",5982.0],["LVA",5884.0],["MDA",5855.0],["TZA",5640.0],["NZL",5478.0],["TTO",5428.0],["LUX",5355.0],["EST",5278.0],["MLT",4861.0],["MUS",4573.0],["NIC",4416.0],["MMR",4338.0],["JAM",4288.0],["SDN",3695.0],["SEN",3652.0],["UGA",3634.0],["ISL",3384.0],["REU",3281.0],["MNG",3270.0],["BRN",3003.0],["LAO",2833.0],["CIV",2787.0],["ZWE",2600.0],["AGO",2217.0],["BWA",2005.0],["HTI",1909.0],["MNE",1776.0],["ETH",1697.0],["AFG",1679.0],["BRB",1668.0],["KGZ",1473.0],["MOZ",1460.0],["GLP",1369.0],["MTQ",1361.0],["BHS",1346.0],["MDV",1319.0],["CMR",1307.0],["GUM",1271.0],["NAM",1263.0],["ZMB",1204.0],["JEY",1197.0],["SUR",1095.0],["CUW",1072.0],["GUY",1001.0],["MLI",922.0],["ABW",888.0],["MDG",859.0],["UZB",834.0],["AND",827.0],["BLZ",801.0],["RWA",748.0],["GMB",719.0],["DJI",688.0],["GIN",668.0],["BEN",661.0],["GRD",653.0],["CYM",651.0],["IMN",630.0],["BFA",605.0],["ATG",605.0],["BMU",571.0],["GUF",565.0],["MRT",563.0],["LCA",552.0],["COD",514.0],["VIR",502.0],["CUB",469.0],["GAB",452.0],["FRO",435.0],["MWI",434.0],["CPV",427.0],["GIB",422.0],["GGY",413.0],["GRL",399.0],["PNG",386.0],["MCO",374.0],["TGO",359.0],["SYC",352.0],["NER",339.0],["LSO",330.0],["BTN",265.0],["KNA",264.0],["SOM",240.0],["VCT",238.0],["NCL",237.0],["MYT",224.0],["DMA",201.0],["SLE",190.0],["BDI",183.0],["LIE",173.0],["TCA",170.0],["LBR",170.0],["SMR",168.0],["TJK",166.0],["FJI",165.0],["SWZ",155.0],["COG",139.0],["ALA",128.0],["MNP",123.0],["BES",105.0],["TKM",101.0],["TCD",97.0],["PYF",82.0],["VGB",82.0],["MAF",80.0],["GNQ",60.0],["GNB",53.0],["AIA",47.0],["STP",44.0],["ASM",34.0],["SPM",34.0],["FSM",29.0],["MHL",27.0],["VUT",20.0],["COM",18.0],["CAF",16.0],["FLK",14.0],["ERI",14.0],["COK",12.0],["SLB",11.0],["PLW",9.0],["MSR",6.0],["VAT",6.0],["PRK",5.0],["TON",3.0],["IOT",3.0],["WLF",3.0],["ATA",2.0],["WSM",1.0],["KIR",1.0]],"arguments":{},"schema":[{"name":"c3","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664767601E12,"submitTime":1.453664771853E12,"finishTime":1.453664780921E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"boxPlot","width":"613","height":"314","xColumns":["c3"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":false}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mapPlot":[],"histogram":[{"key":"bins","value":"20"}],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"boxPlot":[],"lineChart":[],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":"0.51"}],"qqPlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"50a70c8b-c99c-459a-a5d7-a8a5e60a5198"},{"version":"CommandV1","origId":4326,"guid":"605ae13d-688c-4a93-b8e2-45ed5b12275c","subtype":"command","commandType":"auto","position":10.5,"command":"\nfrom __future__ import division\nfrom pyspark.sql.types import FloatType\n\ncountry_traffic_percentage = udf(lambda x:((x)/18825762)*100, FloatType())  # 18825762 : total traffic\ncountry_int_user_percentage = udf(lambda x:((x)/2782084270)*100, FloatType())  # 2782084270 : total internet users in the world\n\ndf_market2 =  df_internetusers_with_code.join(dfc,df_internetusers_with_code['c3_1'] == dfc['c3'] ).select(\"c3\",\"count\",\"InternetUsers\")\ndf_market3 = df_market2.withColumn(\"Percentage_of_gen_traffic\", country_traffic_percentage(df_market2['count']))\ndf_market4 = df_market3.withColumn(\"Percentage_of_internet_users\", country_int_user_percentage(df_market2['InternetUsers'])).sort(df_market3['InternetUsers'], ascending = False)\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"plotOptions":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664784773E12,"submitTime":1.453664789023E12,"finishTime":1.453664784901E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"99f5c9fa-9b1d-44ff-aed5-b6cfaef7277b"},{"version":"CommandV1","origId":4398,"guid":"14f95c7a-8a27-49dc-8de2-417d9ac2bcc7","subtype":"command","commandType":"auto","position":10.75,"command":"%md\nCountries with maximum potential to expand traffic in","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101003E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a3af2f7a-ed07-453b-8397-2175b2302aee"},{"version":"CommandV1","origId":4319,"guid":"26870021-58de-4671-b107-c4a59cb19d2f","subtype":"command","commandType":"auto","position":11.0,"command":"#Countries with maximum potential\ndisplay(df_market4.limit(20))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["CHN",58610.0,6.68110314E8,0.3113287,24.01474],["IND",452955.0,4.02E8,2.406038,14.449598],["USA",6036988.0,2.66441302E8,32.067696,9.577039],["JPN",716938.0,1.09755777E8,3.8082814,3.9450917],["BRA",946074.0,1.03720965E8,5.025422,3.728175],["IDN",275489.0,7.8E7,1.4633617,2.8036535],["DEU",566726.0,6.8131244E7,3.0103748,2.448928],["NGA",31065.0,6.5675984E7,0.16501324,2.3606756],["GBR",651969.0,5.6954584E7,3.4631746,2.0471911],["FRA",556789.0,5.4027428E7,2.9575908,1.9419767],["MEX",279951.0,5.1638402E7,1.4870633,1.8561049],["EGY",152909.0,4.2271899E7,0.81223273,1.5194328],["PHL",163574.0,3.9116638E7,0.86888385,1.4060192],["TUR",517409.0,3.7321199E7,2.7484093,1.3414834],["ESP",394887.0,3.6721233E7,2.0975883,1.319918],["ITA",542485.0,3.594212E7,2.8816097,1.2919134],["PAK",62793.0,3.5063037E7,0.33354825,1.2603154],["CAN",424256.0,2.9659525E7,2.2535927,1.0660901],["ARG",207318.0,2.5523978E7,1.1012462,0.9174409],["POL",75721.0,2.4123917E7,0.4022201,0.8671167]],"arguments":{},"schema":[{"name":"c3","type":"\"string\""},{"name":"count","type":"\"long\""},{"name":"InternetUsers","type":"\"long\""},{"name":"Percentage_of_gen_traffic","type":"\"float\""},{"name":"Percentage_of_internet_users","type":"\"float\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664788728E12,"submitTime":1.453664792963E12,"finishTime":1.453664805885E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"1280.77778","height":"325.77778","xColumns":["c3"],"yColumns":["Percentage_of_internet_users","Percentage_of_gen_traffic"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":false},{"key":"stacked","value":false},{"key":"100_stacked","value":true}],"mapPlot":[],"areaChart":[{"key":"grouped","value":false},{"key":"stacked","value":true},{"key":"100_stacked","value":false}],"boxPlot":[],"lineChart":[],"scatterPlot":[{"key":"loess","value":true},{"key":"bandwidth","value":"0.99"}],"qqPlot":[],"quantilePlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0e7a6e8e-355b-43d3-b076-730d1594269a"},{"version":"CommandV1","origId":4320,"guid":"bbcaca97-0b0b-4ec3-8b72-5f7519ca9d0c","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n####Conclusion\n\n- The maximum traffic is generated by USA. The number of interaction from USA alone is more than the traffic generated by next 7 countries alone.\n- However, the mapping of total internet users(of a country) and Amount of traffic generated by that country (in percentage) reveals a different picture.\n- The traffic generated by the biggest two countries internet user wise (China and India) is very small.Traffic difference exists in some other countries (Indonesia,Nigeria) too. The most probable cause seems to be the difference in time-zone.\n\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101056E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8d4d9349-4add-4026-a590-b3e884f66a8e"},{"version":"CommandV1","origId":4321,"guid":"0d9e8eba-22c2-4f0f-9586-458d08454691","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n####3. Stats on Repeat Clients\n\n- Number of new cookies in the hours  \n- Most preferred platform for repeat users\n- Most preferred platform for new users","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.45366310109E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a347ac52-da8f-44d0-a810-7646b384449e"},{"version":"CommandV1","origId":4399,"guid":"7f470ba0-5789-4536-8449-3cbdec844e3b","subtype":"command","commandType":"auto","position":13.5,"command":"%md\nNumber of new cookies in the hours","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101133E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"21e80aa6-bf6b-41f2-93a2-2ba04752727d"},{"version":"CommandV1","origId":4329,"guid":"43452f69-9387-48f5-9bbd-be0a91bbab26","subtype":"command","commandType":"auto","position":14.0,"command":"#number of new cookies in the hours \ndisplay(DFrame.groupBy('nk').count())","commandVersion":0,"state":"finished","results":{"type":"table","data":[[0.0,7420148.0],[1.0,1.1405614E7]],"arguments":{},"schema":[{"name":"nk","type":"\"long\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664825202E12,"submitTime":1.453664829449E12,"finishTime":1.45366482626E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"698.77778","height":"275.77778","xColumns":["nk"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":false}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mapPlot":[],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"boxPlot":[],"lineChart":[],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":"0.99"}],"quantilePlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"b3d18543-6716-4272-a6d1-e2aafe284caa"},{"version":"CommandV1","origId":4400,"guid":"0198c01a-a650-47a8-bce2-05ee319f6b7b","subtype":"command","commandType":"auto","position":14.5,"command":"%md\nMost preferred platform for repeat users","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101203E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"933b4521-6124-4f1f-80cc-608ecf156257"},{"version":"CommandV1","origId":4330,"guid":"0a37df7e-f0e4-43cb-9096-1d96817b756a","subtype":"command","commandType":"auto","position":15.0,"command":"#Most preferred platform for repeat users\ndisplay(dftest.where(DFrame['nk'] == 1).groupBy('platform').count().sort('count',ascending = False))\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Windows",3453268.0],["Android",3443556.0],["iPhone",2747174.0],[[],772416.0],["IPad",430469.0],["Mac OS",384325.0],["BlackBerry",90106.0],["Linux",40622.0],["Ubuntu",19758.0],["Symbian",9896.0],[" ChromeOS",9772.0],["Nokia S40",2275.0],["PlayStation",1600.0],["BlackberryPlaybook",284.0],["WebOS",64.0],["Debian",29.0]],"arguments":{},"schema":[{"name":"platform","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664829827E12,"submitTime":1.45366483408E12,"finishTime":1.45366483093E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"987.77778","height":"349.77778","xColumns":["platform"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"pieChart":[{"key":"donut","value":true}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"0abafdcc-9872-4a6b-a78e-ea726c44dc9e"},{"version":"CommandV1","origId":4401,"guid":"c8f57077-d72c-4eb2-9266-730ba2df2512","subtype":"command","commandType":"auto","position":15.5,"command":"%md\nMost preferred platform for new users","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101263E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"8b9b5e98-55d2-407b-9a39-71868dbb945d"},{"version":"CommandV1","origId":4331,"guid":"2b6b31c9-f430-40a2-99a8-f7b1b953c5fe","subtype":"command","commandType":"auto","position":16.0,"command":"#Most preferred platform for new users\ndisplay(dftest.where(DFrame['nk'] == 0).groupBy('platform').count().sort('count',ascending = False))\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Windows",3752145.0],["Android",1944219.0],["iPhone",957378.0],[[],235166.0],["Mac OS",232185.0],["IPad",221517.0],["Linux",34333.0],["BlackBerry",13878.0],["Ubuntu",13791.0],[" ChromeOS",5597.0],["Symbian",5358.0],["Nokia S40",3214.0],["PlayStation",1148.0],["BlackberryPlaybook",147.0],["Debian",56.0],["WebOS",16.0]],"arguments":{},"schema":[{"name":"platform","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664836604E12,"submitTime":1.453664840838E12,"finishTime":1.45366483754E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"pieChart","width":"1035.77778","height":"362.77778","xColumns":["platform"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"pieChart":[{"key":"donut","value":true}]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"a2c8a6ed-1638-4f40-9b93-3da166b029c8"},{"version":"CommandV1","origId":4380,"guid":"d07fed60-9dcc-4ce4-904d-c1b5dc1e44d8","subtype":"command","commandType":"auto","position":17.0,"command":"%md\n####Conclusion\n- Repeat Users:\n  - Mobile devices generate even higher number in case of repeat number. Windows(30%) is generating almost half as much traffic as the Mobile device( including iPad). \n- New Users:\n  - This is the first stat where we see that the visitors prefer  PC (51%) over Mobile devices (39%). This is quite contradictory to the overall usage patterns and stats for repeat users, where Mobile devices were preferred. This could be because registering for a new service on mobile devices is cumbursome. ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101335E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"62781b13-a143-48ad-a39d-56c2b6c42df6"},{"version":"CommandV1","origId":4384,"guid":"c9ee8bf3-4e3e-4814-a27a-f3d3f9b7f8f9","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n####4. Stats on Domains of the visited websites/urls\n\n- Most visited hostnames\n\n\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101381E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"98f1f3a7-e321-4ce0-9fb4-25a7bcd19c9e"},{"version":"CommandV1","origId":4402,"guid":"1b893da9-dacc-4369-ad17-76b65d2ceed3","subtype":"command","commandType":"auto","position":19.5,"command":"%md\nMost visited hostnames","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101429E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3d66da50-185a-4f2b-ac82-41560c5ccb26"},{"version":"CommandV1","origId":4385,"guid":"f82f91c3-2b0e-49b6-b3a1-b8c496457a79","subtype":"command","commandType":"auto","position":20.0,"command":"#Most visited hostnames\nimport urlparse\n\ndef ua_get_hostname(url):   \n    try:\n      hostname = urlparse.urlparse(str(url)).hostname\n      return hostname\n    except:\n        return None\n\n#registering custom User Defined Functions\nget_url = udf(lambda x:ua_get_hostname(x), StringType())\n\ndf_hostname = dftest.withColumn(\"hostname\", get_url('u'))\ndf_results = df_hostname.groupBy(df_hostname['hostname']).count().sort(\"count\",ascending = False)\ndisplay(df_results.where(df_results['hostname'] != 'null').limit(10))\n\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["cdn.adf.ly",2014734.0],["static.mixerbox.com",958177.0],["trib.al",492244.0],["agents.trulia.com",317229.0],["www.buzzfeed.com",213426.0],["s3-eu-west-1.amazonaws.com",134010.0],["trioninteractive.com",110723.0],["www.youtube.com",108036.0],["apps.facebook.com",106433.0],["dl.dropbox.com",96135.0]],"arguments":{},"schema":[{"name":"hostname","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664842323E12,"submitTime":1.453664846576E12,"finishTime":1.453664865001E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"1554.33334","height":"426.33334","xColumns":["hostname"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ee9a4d28-21a6-4ea3-9fdb-b2c52760f6be"},{"version":"CommandV1","origId":4407,"guid":"ea8856ee-b998-4be1-abaa-2965ad189689","subtype":"command","commandType":"auto","position":20.09375,"command":"%md\n####5.Other stats /Extra","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.453663101543E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"7e2a12f2-7b24-4ae6-b794-06a3d530249e"},{"version":"CommandV1","origId":4413,"guid":"bd6a3276-c1fd-4a4a-a53a-b47e77e199eb","subtype":"command","commandType":"auto","position":20.18475341796875,"command":"%md\n- Which top city prefer Chrome over IE on Windows","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.45366310159E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"876c9972-404d-4ecb-a1a6-9edc422eb9d3"},{"version":"CommandV1","origId":4403,"guid":"b2045c00-d8dd-4751-9123-514b304a4fb1","subtype":"command","commandType":"auto","position":20.1849365234375,"command":"dftest.registerAsTable(\"dftest\")\ndf_no_null = sqlContext.sql(\"select * from dftest where cy != 'null'  AND browser != 'null' AND platform = 'Windows' AND (browser = 'Chrome' or browser = 'Microsoft Internet Explorer')\")\nt1 = df_no_null.groupBy('cy','browser').count().sort('count',ascending = False)\npdf_df_browser = rows_to_def(t1.where(t1['count'] > 10000).collect())\n\ndisplay(t1.where(t1['count'] > 10000)) # to keep it simple, missing data won't be relavent in answering the question\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["Buffalo","Microsoft Internet Explorer",530934.0],["Mountain View","Microsoft Internet Explorer",79929.0],["Ashburn","Microsoft Internet Explorer",70181.0],["San Francisco","Microsoft Internet Explorer",60694.0],["Hanoi","Chrome",50342.0],["Montral","Microsoft Internet Explorer",47144.0],["Istanbul","Chrome",45289.0],["Kansas City","Microsoft Internet Explorer",44106.0],["Cheyenne","Microsoft Internet Explorer",43707.0],["Taipei","Chrome",36075.0],["Bangkok","Chrome",35971.0],["So Paulo","Chrome",35459.0],["Hanoi","Microsoft Internet Explorer",32161.0],["Dallas","Microsoft Internet Explorer",29639.0],["Boardman","Microsoft Internet Explorer",26366.0],["Bogot","Chrome",23992.0],["Paris","Microsoft Internet Explorer",23407.0],["Tbilisi","Chrome",21247.0],["London","Chrome",20837.0],["Rochester","Microsoft Internet Explorer",20113.0],["Buffalo","Chrome",19633.0],["Cairo","Chrome",19593.0],["Lenoir","Microsoft Internet Explorer",19135.0],["Bucharest","Chrome",18354.0],["Lima","Chrome",18131.0],["Las Vegas","Microsoft Internet Explorer",18074.0],["Rio De Janeiro","Chrome",17379.0],["Ho Chi Minh City","Microsoft Internet Explorer",16756.0],["Ho Chi Minh City","Chrome",16560.0],["Buenos Aires","Chrome",16340.0],["New York","Chrome",16304.0],["Los Angeles","Microsoft Internet Explorer",15954.0],["Wilkes Barre","Microsoft Internet Explorer",15813.0],["Milan","Chrome",15751.0],["Central District","Chrome",15532.0],["Santiago","Chrome",15216.0],["Ankara","Chrome",15180.0],["New York","Microsoft Internet Explorer",14986.0],["1 Decembrie","Microsoft Internet Explorer",14891.0],["Paris","Chrome",14295.0],["Tokyo","Microsoft Internet Explorer",14280.0],["Montral","Chrome",14019.0],["Singapore","Chrome",13892.0],["San Antonio","Microsoft Internet Explorer",13154.0],["Chicago","Microsoft Internet Explorer",13013.0],["Ashburn","Chrome",11872.0],["London","Microsoft Internet Explorer",11617.0],["Rome","Chrome",11153.0],["Bangkok","Microsoft Internet Explorer",10626.0],["Athens","Chrome",10602.0],["Salvador","Chrome",10436.0],["Izmir","Chrome",10430.0],["Moscow","Chrome",10046.0],["Istanbul","Microsoft Internet Explorer",10031.0],["Medelln","Chrome",10014.0]],"arguments":{},"schema":[{"name":"cy","type":"\"string\""},{"name":"browser","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Command skipped","error":null,"startTime":1.453664871317E12,"submitTime":1.45366487556E12,"finishTime":1.453664876708E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"2438","height":"438","xColumns":["cy"],"yColumns":["count"],"pivotColumns":["browser"],"pivotAggregation":"sum","customPlotOptions":{"pieChart":[{"key":"donut","value":true}],"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"mapPlot":[],"areaChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"boxPlot":[],"lineChart":[],"scatterPlot":[{"key":"loess","value":false},{"key":"bandwidth","value":"0.22"}],"qqPlot":[],"quantilePlot":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"ed0ad5b4-6435-4c13-93ee-e8f28f7da367"},{"version":"CommandV1","origId":4439,"guid":"5d67111d-c8d5-43a5-adfb-e4479370d618","subtype":"command","commandType":"auto","position":23.6849365234375,"command":"%md\n- Activity Timeline (per minute)","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"3a7153c3-0b9d-4946-899e-a1f7a16f8c8e"},{"version":"CommandV1","origId":4427,"guid":"50e1e63a-b953-41b8-b1eb-05f8e4aebcc6","subtype":"command","commandType":"auto","position":27.1849365234375,"command":"from pyspark.sql.types import TimestampType\nfrom datetime import datetime\ndef ua_time(time1):   \n    return  time.strftime(\"%Y-%m-%d %H:%M\", time.gmtime(int(time1)))   \n  \n\nget_time = udf(lambda x:ua_time(x), StringType())\nDFrame_time = DFrame.withColumn(\"time\", get_time(DFrame.t)).select('time')\ndisplay(DFrame_time.groupBy('time').count().sort('time'))\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["2015-03-25 12:59",678.0],["2015-03-25 13:00",299570.0],["2015-03-25 13:01",305748.0],["2015-03-25 13:02",306552.0],["2015-03-25 13:03",306986.0],["2015-03-25 13:04",307762.0],["2015-03-25 13:05",310037.0],["2015-03-25 13:06",308588.0],["2015-03-25 13:07",311558.0],["2015-03-25 13:08",312539.0],["2015-03-25 13:09",312750.0],["2015-03-25 13:10",309868.0],["2015-03-25 13:11",309052.0],["2015-03-25 13:12",313662.0],["2015-03-25 13:13",311236.0],["2015-03-25 13:14",312214.0],["2015-03-25 13:15",310081.0],["2015-03-25 13:16",311752.0],["2015-03-25 13:17",311491.0],["2015-03-25 13:18",312640.0],["2015-03-25 13:19",314036.0],["2015-03-25 13:20",313446.0],["2015-03-25 13:21",317001.0],["2015-03-25 13:22",315259.0],["2015-03-25 13:23",314849.0],["2015-03-25 13:24",312616.0],["2015-03-25 13:25",310736.0],["2015-03-25 13:26",308825.0],["2015-03-25 13:27",305331.0],["2015-03-25 13:28",307003.0],["2015-03-25 13:29",310745.0],["2015-03-25 13:30",313832.0],["2015-03-25 13:31",312955.0],["2015-03-25 13:32",318579.0],["2015-03-25 13:33",317904.0],["2015-03-25 13:34",317139.0],["2015-03-25 13:35",314703.0],["2015-03-25 13:36",316887.0],["2015-03-25 13:37",317602.0],["2015-03-25 13:38",317917.0],["2015-03-25 13:39",317882.0],["2015-03-25 13:40",315576.0],["2015-03-25 13:41",317340.0],["2015-03-25 13:42",318490.0],["2015-03-25 13:43",315023.0],["2015-03-25 13:44",316345.0],["2015-03-25 13:45",315489.0],["2015-03-25 13:46",317309.0],["2015-03-25 13:47",319991.0],["2015-03-25 13:48",318300.0],["2015-03-25 13:49",317880.0],["2015-03-25 13:50",316586.0],["2015-03-25 13:51",317240.0],["2015-03-25 13:52",317634.0],["2015-03-25 13:53",318582.0],["2015-03-25 13:54",318048.0],["2015-03-25 13:55",317335.0],["2015-03-25 13:56",317954.0],["2015-03-25 13:57",317256.0],["2015-03-25 13:58",316985.0],["2015-03-25 13:59",316388.0]],"arguments":{},"schema":[{"name":"time","type":"\"string\""},{"name":"count","type":"\"long\""}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"SparkException: Job aborted due to stage failure: Task 3 in stage 155.0 failed 4 times, most recent failure: Lost task 3.3 in stage 155.0 (TID 15435, 10.224.252.171): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File \"/databricks/spark/python/pyspark/worker.py\", line 111, in main\n    process()\n  File \"/databricks/spark/python/pyspark/worker.py\", line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File \"/databricks/spark/python/pyspark/serializers.py\", line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File \"/databricks/spark/python/pyspark/sql/functions.py\", line 1427, in <lambda>\n    func = lambda _, it: map(lambda x: returnType.toInternal(f(*x)), it)\n  File \"/databricks/spark/python/pyspark/sql/types.py\", line 190, in toInternal\n    seconds = (calendar.timegm(dt.utctimetuple()) if dt.tzinfo\nAttributeError: 'str' object has no attribute 'tzinfo'\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.<init>(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.sql.execution.BatchPythonEvaluation$$anonfun$doExecute$1.apply(python.scala:397)\n\tat org.apache.spark.sql.execution.BatchPythonEvaluation$$anonfun$doExecute$1.apply(python.scala:362)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:710)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:710)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsWithPreparationRDD.compute(MapPartitionsWithPreparationRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:73)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:41)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:88)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:214)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:","error":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 3 in stage 155.0 failed 4 times, most recent failure: Lost task 3.3 in stage 155.0 (TID 15435, 10.224.252.171): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File \"/databricks/spark/python/pyspark/worker.py\", line 111, in main\n    process()\n  File \"/databricks/spark/python/pyspark/worker.py\", line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File \"/databricks/spark/python/pyspark/serializers.py\", line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File \"/databricks/spark/python/pyspark/sql/functions.py\", line 1427, in <lambda>\n    func = lambda _, it: map(lambda x: returnType.toInternal(f(*x)), it)\n  File \"/databricks/spark/python/pyspark/sql/types.py\", line 190, in toInternal\n    seconds = (calendar.timegm(dt.utctimetuple()) if dt.tzinfo\nAttributeError: 'str' object has no attribute 'tzinfo'\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.<init>(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.sql.execution.BatchPythonEvaluation$$anonfun$doExecute$1.apply(python.scala:397)\n\tat org.apache.spark.sql.execution.BatchPythonEvaluation$$anonfun$doExecute$1.apply(python.scala:362)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:710)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:710)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsWithPreparationRDD.compute(MapPartitionsWithPreparationRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:73)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:41)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:88)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:214)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1283)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1271)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1270)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1270)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:697)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:697)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:697)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1496)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1458)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1447)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:567)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1827)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1947)\n\tat org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1007)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:147)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:108)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:310)\n\tat org.apache.spark.rdd.RDD.reduce(RDD.scala:989)\n\tat org.apache.spark.rdd.RDD$$anonfun$takeOrdered$1.apply(RDD.scala:1370)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:147)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:108)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:310)\n\tat org.apache.spark.rdd.RDD.takeOrdered(RDD.scala:1357)\n\tat org.apache.spark.sql.execution.TakeOrderedAndProject.collectData(basicOperators.scala:257)\n\tat org.apache.spark.sql.execution.TakeOrderedAndProject.executeCollect(basicOperators.scala:263)\n\tat org.apache.spark.sql.DataFrame$$anonfun$collect$1.apply(DataFrame.scala:1385)\n\tat org.apache.spark.sql.DataFrame$$anonfun$collect$1.apply(DataFrame.scala:1385)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:56)\n\tat org.apache.spark.sql.DataFrame.withNewExecutionId(DataFrame.scala:1903)\n\tat org.apache.spark.sql.DataFrame.collect(DataFrame.scala:1384)\n\tat org.apache.spark.sql.DataFrame.head(DataFrame.scala:1314)\n\tat org.apache.spark.sql.DataFrame.take(DataFrame.scala:1377)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation0(OutputAggregator.scala:80)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation(OutputAggregator.scala:42)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.com$databricks$backend$daemon$driver$PythonDriverLocal$$outputSuccess(PythonDriverLocal.scala:411)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal$$anonfun$repl$3.apply(PythonDriverLocal.scala:153)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal$$anonfun$repl$3.apply(PythonDriverLocal.scala:150)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.withInterpLock(PythonDriverLocal.scala:365)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.repl(PythonDriverLocal.scala:150)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:177)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:485)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$3.apply(DriverWrapper.scala:485)\n\tat scala.util.Try$.apply(Try.scala:161)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:482)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:384)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:195)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File \"/databricks/spark/python/pyspark/worker.py\", line 111, in main\n    process()\n  File \"/databricks/spark/python/pyspark/worker.py\", line 106, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File \"/databricks/spark/python/pyspark/serializers.py\", line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File \"/databricks/spark/python/pyspark/sql/functions.py\", line 1427, in <lambda>\n    func = lambda _, it: map(lambda x: returnType.toInternal(f(*x)), it)\n  File \"/databricks/spark/python/pyspark/sql/types.py\", line 190, in toInternal\n    seconds = (calendar.timegm(dt.utctimetuple()) if dt.tzinfo\nAttributeError: 'str' object has no attribute 'tzinfo'\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:166)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.<init>(PythonRDD.scala:207)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:125)\n\tat org.apache.spark.sql.execution.BatchPythonEvaluation$$anonfun$doExecute$1.apply(python.scala:397)\n\tat org.apache.spark.sql.execution.BatchPythonEvaluation$$anonfun$doExecute$1.apply(python.scala:362)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:710)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$17.apply(RDD.scala:710)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsWithPreparationRDD.compute(MapPartitionsWithPreparationRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:300)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:264)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:73)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:41)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:88)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:214)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n","startTime":1.453667374155E12,"submitTime":1.453667378458E12,"finishTime":1.453667384419E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"lineChart","width":"1112.77778","height":"293.77778","xColumns":["time"],"yColumns":["count"],"pivotColumns":[],"pivotAggregation":"sum","customPlotOptions":{"barChart":[{"key":"grouped","value":true},{"key":"stacked","value":false},{"key":"100_stacked","value":false}],"lineChart":[]},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"648d88ac-cc21-4a68-aad3-e6af5f23900b"},{"version":"CommandV1","origId":4282,"guid":"8d9715bc-c875-4912-9691-b1ce34634f33","subtype":"command","commandType":"auto","position":27.9349365234375,"command":"%md\n#####Details of the applicant  \nName: Snehasis Ghosh  \nemail_id : sghosh9@ncsu.edu  \nPhone number: 9199468082","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"startTime":0.0,"submitTime":1.4536631015E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"kagarwa@ncsu.edu","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"nuid":"5fb0dad0-ae66-40d9-80a5-b0e87f086a34"}],"dashboards":[],"guid":"8397c917-137d-497a-8cab-1e469d0e356a","globalVars":{},"iPythonMetadata":null};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/201601061423090800-46e7af8a4d4185dce6c51957db857079eb78e351/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
